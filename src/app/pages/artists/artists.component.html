<section class="artists-page">
  <header class="artists-page__header">
    <h1>Buscar Artistas</h1>
    <p>
      Descubre y explora artistas independientes de la escena underground.
    </p>
    
    <!-- Barra de búsqueda -->
    <div class="search-bar-container">
      <input 
        type="search" 
        class="search-input" 
        placeholder="Buscar artistas..."
        [(ngModel)]="searchQuery"
        (input)="onSearchInput(searchQuery)"
      />
      <span class="search-status" *ngIf="isSearching">Buscando...</span>
      <span class="search-error" *ngIf="searchError">{{ searchError }}</span>
    </div>
    
    <div class="search-elements-container">
        <button class="filter-btn" (click)="toggleFilters()">
          <img src="assets/images/ui/filtrar.png" alt="Filtros"/>
        </button>
          <div class="filter-dropdown" *ngIf="showFilters">
            <label>Filtrar por nacionalidad
              <select [(ngModel)]="selectedCountry" (change)="applyFilters()">
                <option value="">Todos</option>
                <option *ngFor="let country of countries" [value]="country"> {{country}}</option>   
              </select> 
            </label>
            <label>Filtrar por género
              <select [(ngModel)]="selectedGenre" (change)="applyFilters()">
                <option value="">Todos</option>
                <option *ngFor="let genre of genres" [value]="genre">{{ genre }}</option>
              </select>
            </label>
          </div>

        
          <div class="sort-tags">
            <button (click)="sortBy('name')" [ngClass]="{ active: selectedSort === 'name'}">Título</button>
            <button (click)="sortBy('createdAt')" [ngClass]="{active: selectedSort === 'createdAt' }">Fecha de creación</button>
          </div>
    </div>
  </header>
  
  <!-- Mensaje de carga -->
  <div class="loading-message" *ngIf="isSearching">
    <p>Cargando artistas...</p>
  </div>
  
  <!-- Resultados del backend -->
  <div class="search-results" *ngIf="!isSearching && backendArtists.length > 0">
    <h2 *ngIf="searchQuery">Resultados de búsqueda ({{ backendArtists.length }})</h2>
    <h2 *ngIf="!searchQuery">Artistas ({{ backendArtists.length }})</h2>
    <div class="artist-grid">
      <article class="artist-card" *ngFor="let artist of backendArtists">
        <img
          [src]="artist.avatarUrl || 'assets/images/artists/default-artist.svg'"
          [alt]="'Perfil de ' + artist.username"
          loading="lazy"
        />
        <div class="artist-card__content">
          <h3>{{ artist.username }}</h3>
          <p class="artist-card__genre">{{ artist.role }}</p>
          <p class="artist-card__bio">{{ artist.bio || 'Sin biografía disponible' }}</p>
        </div>
      </article>
    </div>
  </div>
  
  <!-- Mensaje cuando no hay resultados -->
  <div class="no-results" *ngIf="!isSearching && backendArtists.length === 0 && searchQuery">
    <p>No se encontraron artistas con "{{ searchQuery }}"</p>
  </div>
  
  <!-- Fallback a artistas locales si el backend falla y no hay búsqueda -->
  <div class="artist-grid" *ngIf="!isSearching && backendArtists.length === 0 && !searchQuery && artists.length > 0">
    <article class="artist-card" *ngFor="let artist of artists">
      <img
        [src]="artist.image"
        [alt]="'Retrato de ' + artist.name"
        loading="lazy"
      />
      <div class="artist-card__content">
        <h3>{{ artist.name }}</h3>
        <p class="artist-card__genre">{{ artist.genre }}</p>
        <p class="artist-card__bio">{{ artist.bio }}</p>
      </div>
    </article>
  </div>
</section>

