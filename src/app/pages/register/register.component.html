<section class="register-page">
  <h1>Crear cuenta</h1>

  <form [formGroup]="registerForm" (ngSubmit)="submit()" novalidate>
    <div class="form-field">
      <label for="name">Nombre</label>
      <input id="name" type="text" formControlName="name" />
      <div class="error" *ngIf="name?.invalid && (name?.touched || submitted())">
        <span *ngIf="name?.errors?.['required']">Requerido</span>
        <span *ngIf="name?.errors?.['minlength']">Mínimo 2 caracteres</span>
      </div>
    </div>

    <div class="form-field">
      <label for="email">Correo electrónico</label>
      <input id="email" type="email" formControlName="email" />
      <div class="error" *ngIf="email?.invalid && (email?.touched || submitted())">
        <span *ngIf="email?.errors?.['required']">Requerido</span>
        <span *ngIf="email?.errors?.['email']">Email inválido</span>
      </div>
    </div>

    <div class="form-field">
      <label for="password">Contraseña</label>
      <input id="password" type="password" formControlName="password" />
      <div class="error" *ngIf="password?.invalid && (password?.touched || submitted())">
        <span *ngIf="password?.errors?.['required']">Requerido</span>
        <span *ngIf="password?.errors?.['minlength']">Mínimo 8 caracteres</span>
      </div>
    </div>

    <div class="form-field">
      <label for="confirm">Confirmación</label>
      <input id="confirm" type="password" formControlName="confirm" />
      <div class="error" *ngIf="(confirm?.touched || submitted()) && (confirm?.invalid || passwordMismatch())">
        <span *ngIf="confirm?.errors?.['required']">Requerido</span>
        <span *ngIf="passwordMismatch()">Las contraseñas no coinciden</span>
      </div>
    </div>

    <div class="form-field">
      <label for="role">Rol</label>
      <select id="role" formControlName="role">
        <option value="artista">Artista</option>
        <option value="oyente">Oyente</option>
      </select>
      <div class="error" *ngIf="role?.invalid && (role?.touched || submitted())">
        <span>Requerido</span>
      </div>
    </div>

    <p class="api-error" *ngIf="apiError()">{{ apiError() }}</p>

    <button type="submit" [disabled]="submitting()">
      {{ submitting() ? 'Registrando…' : 'Registrarme' }}
    </button>
  </form>
</section>
