<h1>Mis artículos de merch</h1>

<div class="loading-state" *ngIf="isLoading">Cargando...</div>
<div class="error-state" *ngIf="errorMessage">{{ errorMessage }}</div>
<div class="empty-state" *ngIf="!isLoading && !errorMessage && merch.length === 0">
  No tienes artículos de merchandising todavía.
</div>

<div class="merch-grid" *ngIf="!isLoading && !errorMessage">
  <article class="merch-card" *ngFor="let item of merch">
    
    <button class="edit-btn" (click)="openEditionModal(item)">
      <img src="assets/images/ui/edit.png" alt="Editar">
    </button>

    <figure class="merch-card__image">
      <img [src]="item.cover?.url" [alt]="item.title">
    </figure>

    <div class="merch-card__body">
      <h3>{{ item.title }}</h3>
      <p class="merch-card__price">{{ item.priceCents/100 | currency:'EUR' }}</p>
    </div>

  </article>
</div>

<div class="modal-backdrop" *ngIf="modalOpen">
  <div class="modal">

    <h2>Editar artículo</h2>

    <label>Nombre:
      <input type="text" [(ngModel)]="editableItem.title">
    </label>

    <label>Precio (€):
      <input type="number" step="0.01" [(ngModel)]="editableItem.priceCents" [value]="editableItem.priceCents / 100">
    </label>

    <label>Stock:
      <input type="number" [(ngModel)]="editableItem.stock">
    </label>

    <label>Descripción:
      <textarea [(ngModel)]="editableItem.description"></textarea>
    </label>

    <label>Imagen:
      <input type="file" accept="image/*" (change)="onImageChange($event)" />
      <small *ngIf="selectedImageFile">Seleccionado: {{ selectedImageFile.name }}</small>
    </label>

    <div class="modal-actions">
      <button class="cancel-btn" (click)="closeEditionModal()">Cancelar</button>
      <button class="save-btn" (click)="saveChanges()">Guardar</button>
    </div>

  </div>
</div>
